<form
  name="ModalForm"
  ng-submit="ModalCtrl.submit(ModalForm)"
  data-modal="invoice-search"
  bh-form-defaults
  novalidate>

  <div class="modal-header">
    <ol class="headercrumb">
      <li class="static" translate>FORM.INFO.INVOICES</li>
      <li class="title" translate>FORM.INFO.SEARCH</li>
    </ol>
  </div>

  <div class="modal-body" style="overflow: auto; max-height: 400px;">

    <!-- billing date fieldset -->
    <fieldset>
      <legend translate>FORM.LABELS.BILLING_DATE</legend>

      <bh-date-interval
        validation-trigger="ModalForm.$submitted"
        date-from="ModalCtrl.params.billingDateFrom"
        date-to="ModalCtrl.params.billingDateTo"
        mode="clean">
      </bh-date-interval>
    </fieldset>

    <br />

    <!-- invoice details fieldset -->
    <fieldset>
      <legend translate> FORM.LABELS.INVOICES_DETAILS </legend>

      <div class="form-group" ng-class="{ 'has-error' : ModalForm.$submitted && ModalForm.reference.$invalid }">
        <label class="control-label">{{ 'FORM.LABELS.REFERENCE' | translate }}</label>
        <span style="display:inline-block;" class="pull-right">
          <a href ng-click="ModalCtrl.clear('reference')" tabindex="-1">
            <i class="fa fa-eraser"></i> <span translate>FORM.BUTTONS.CLEAR</span>
          </a>
        </span>
        <input type="text" class="form-control" name="reference"ng-model="ModalCtrl.params.reference">
        <div class="help-block" ng-messages="ModalForm.reference.$error" ng-show="ModalForm.$submitted">
          <div ng-messages-include="partials/templates/messages.tmpl.html"></div>
        </div>
      </div>

      <div class="form-group" ng-class="{ 'has-error' : ModalForm.$submitted && ModalForm.service.$invalid }">
        <label class="control-label">{{ 'FORM.LABELS.SERVICE' | translate }}</label>
        <span style="display:inline-block;" class="pull-right">
          <a href ng-click="ModalCtrl.clear('service_id')" tabindex="-1">
            <i class="fa fa-eraser"></i> <span translate>FORM.BUTTONS.CLEAR</span>
          </a>
        </span>
        <select
          class="form-control"
          name="service"
          ng-model="ModalCtrl.params.service_id"
          ng-options="s.id as s.name for s in ModalCtrl.services | orderBy:'name'">
          <option value="" disabled>{{ 'FORM.SELECT.SERVICE' | translate }}</option>
        </select>
      </div>

      <div class="form-group" ng-class="{ 'has-error' : ModalForm.$submitted && ModalForm.user.$invalid }">
        <label class="control-label">{{ 'FORM.LABELS.USER' | translate }}</label>
        <span style="display:inline-block;" class="pull-right">
          <a href ng-click="ModalCtrl.clear('user_id')" tabindex="-1">
            <i class="fa fa-eraser"></i> <span translate>FORM.BUTTONS.CLEAR</span>
          </a>
        </span>
        <select
          class="form-control"
          name="user"
          ng-model="ModalCtrl.params.user_id"
          ng-options="u.id as u.display_name for u in ModalCtrl.users | orderBy:'display_name'">
          <option value="" disabled translate>FORM.SELECT.USER</option>
        </select>
      </div>

      <div class="form-group">
        <bh-find-patient
          on-search-complete="ModalCtrl.setPatient(patient)"
          on-register-api="ModalCtrl.onPatientSearchApiCallback(api)"
          validation-trigger="ModalForm.$submitted">
        </bh-find-patient>
      </div>
    </fieldset>
  </div>

  <div class="modal-footer">
    <button type="button" class="btn btn-default" ng-click="ModalCtrl.cancel()" translate>
      FORM.BUTTONS.CLOSE
    </button>
    <button class="btn btn-primary" type="submit" data-method="submit" translate>
      FORM.BUTTONS.SUBMIT
    </button>
  </div>
</form>
