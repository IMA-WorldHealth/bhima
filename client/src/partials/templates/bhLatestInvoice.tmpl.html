<!-- LATEST INVOICE  -->

<div class="panel panel-default">
  <div class="panel-heading">
    <span class="glyphicon glyphicon-file"></span>
    <strong>{{ "TABLE.COLUMNS.LAST_BILL" | translate }} </strong>
    <span>
      {{ "TABLE.COLUMNS.OF" | translate }} {{ $ctrl.patientInvoice.invoicesLength || 0 }} {{ "TABLE.COLUMNS.INVOICES" | translate }}
    </span>
    <span class="pull-right">
      <bh-pdf-link
        pdf-url="/reports/finance/financialPatient/{{ $ctrl.debtorUuid }}"
        disable-cache="true"
        button-text="FORM.BUTTONS.PRINT_FINANCIAL_ACT"
      >
      </bh-pdf-link>
    </span>
  </div>
  <div class="panel-body" style="height : 250px;">

    <div style="text-align : left; font-size : 1em; ">
      <!-- FIXME Bad use of table  -->
      <table ng-if="$ctrl.patientInvoice.invoicesLength" style="width:100%; vertical-align:top">
        <tr>
          <td style="width:10%"><strong>{{ "TABLE.COLUMNS.INVOICE_ID" | translate }}</strong></td>
          <td style="width:40%">{{ $ctrl.patientInvoice.reference }} </td>
          <td style="width:50%">
            <div ng-show="$ctrl.patientBalance < 0">
              <strong>{{ 'CASH.CAUTION_REMAINING' | translate }}: {{ $ctrl.patientBalance * -1 | currency }}</strong><br>
              <strong>{{ "TABLE.COLUMNS.REMAINING_BALANCE" | translate }}: {{ 0 | currency }}</strong>
            </div>
            <div ng-hide="$ctrl.patientBalance < 0">
              <strong>{{ "TABLE.COLUMNS.REMAINING_BALANCE" | translate }}: {{ $ctrl.patientInvoice.balance | currency }}</strong>
            </div>
          </td>
        </tr>

        <tr>
          <td><strong>{{ "TABLE.COLUMNS.DATE" | translate }}</strong></td>
          <td>{{ $ctrl.patientInvoice.date | date }}</td>
          <td>
            <div ng-show="$ctrl.patientBalance < 0">
              <i class="fa fa-info-circle text-primary"></i> {{ "CASH.CAUTION_COVER" | translate }}
            </div>

            <div ng-hide="$ctrl.patientBalance < 0">
              <span ng-if="$ctrl.patientInvoice.credit === 0">
                <i class="fa fa-info-circle text-primary"></i> {{ "TABLE.COLUMNS.NO_PAYMENTS" | translate }}
              </span>

              <span ng-if="$ctrl.patientInvoice.numberPayment > 0">
                <i class="fa fa-info-circle text-primary"></i> {{ $ctrl.patientInvoice.numberPayment }} {{ "TABLE.COLUMNS.PAYMENT_INVOICE" | translate }}
              </span>
            </div>

          </td>
        </tr>

        <tr>
          <td><strong>{{ "TABLE.COLUMNS.TOTAL_COST" | translate }}</strong></td>
          <td>{{ $ctrl.patientInvoice.cost | currency }}</td>
          <td>
            <div ng-hide="$ctrl.patientBalance < 0">
              <span ng-if="$ctrl.patientInvoice.balance !== 0">
                <i class="fa fa-warning text-danger"></i> {{ "TABLE.COLUMNS.UNPAID_INVOICE_1" | translate }}
                <strong>{{ $ctrl.patientInvoice.durationDays }}</strong> {{ "TABLE.COLUMNS.UNPAID_INVOICE_2" | translate }}
              </span>

              <span ng-if="$ctrl.patientInvoice.balance === 0">
                <i  class="fa fa-check-circle text-success"></i> {{ "TABLE.COLUMNS.THIS_INVOICE_FULL" | translate }}
              </span>
            </div>
          </td>
        </tr>

        <tr>
          <td><strong>{{ "TABLE.COLUMNS.BILLED_BY" | translate }}</strong></td>
          <td>{{ $ctrl.patientInvoice.display_name }}</td>
          <td></td>
        </tr>
      </table>
      <table ng-if="!$ctrl.patientInvoice.invoicesLength" style="width:100%; vertical-align:top">
        <tr>
          <td style="text-align: center; font-size: +16; width:100%;">
            <h3>
              <i class="fa fa-file-o"></i>
              <strong>
                {{ "TABLE.COLUMNS.NO_RECORDED" | translate }}
              </strong>
            </h3>
          </td>
        </tr>
      </table>

    </div>
  </div>
</div>


<!-- end of Latest Invoice   -->
