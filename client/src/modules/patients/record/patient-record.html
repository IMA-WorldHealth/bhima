<div class="flex-header">
  <div class="bhima-title">
    <ol class="headercrumb">
      <li class="static" translate>TREE.HOSPITAL</li>
      <li class="static"><a ui-sref="patientRegistry" translate>PATIENT_RECORDS.TITLE</a></li>
      <li class="title">{{ PatientRecordCtrl.patient.name }}</li>
    </ol>
  </div>
</div>

<div class="flex-content">

  <!-- Unknown patient state -->
  <div class="container-fluid" ng-if="!PatientRecordCtrl.patient && PatientRecordCtrl.loading===false">
    <div class="alert alert-danger" id="nopatient">
      <span class="fa fa-search"></span> <span translate>PATIENT_RECORDS.NOT_FOUND</span>
    </div>
  </div>

  <div class="container">

    <div ng-if="PatientRecordCtrl.patient">
      <!-- Patient details row -->
      <div class="row">
        <div class="col-md-12">

          <div class="panel panel-primary">
            <div class="panel-heading clearfix">
              <span class="fa fa-list-alt"></span>
              <span translate>FORM.LABELS.PATIENT_DETAILS</span>
            </div>

            <div class="panel-body">
              <div class="col-sm-4">
                <div>

                  <dl>
                    <dt translate>FORM.LABELS.NAME</dt>
                    <dd id="name">{{::PatientRecordCtrl.patient.name}}</dd>

                    <dt translate>FORM.LABELS.PATIENT_ID</dt>
                    <dd id="patientID">{{::PatientRecordCtrl.patient.reference}}</dd>

                    <dt translate>FORM.LABELS.HOSPITAL_FILE_NR</dt>
                    <dd id="hospitalNo">{{::PatientRecordCtrl.patient.hospital_no}}</dd>

                    <dt translate>TABLE.COLUMNS.DATE_REGISTERED</dt>
                    <dd><span am-time-ago="PatientRecordCtrl.patient.registration_date"></span></dd>
                  </dl>

                </div>
              </div>

              <div class="col-sm-4">

                <dl>
                  <dt translate>TABLE.COLUMNS.AGE</dt>
                  <dd id="age">{{::PatientRecordCtrl.patient.age}}</dd>

                  <dt translate>TABLE.COLUMNS.DOB</dt>
                  <dd id="dob">{{::PatientRecordCtrl.patient.dobFormatted}}</dd>
                  <p ng-if="PatientRecordCtrl.patient.dob_unknown_date" class="text-info">
                    <i class="fa fa-info-circle"></i>
                    <span translate>PATIENT_RECORDS.DOB_NOT_SPECIFIED</span>
                  </p>

                  <dt translate>TABLE.COLUMNS.GENDER</dt>
                  <dd id="gender">{{::PatientRecordCtrl.patient.sex}}</dd>
                </dl>
              </div>

              <div class="col-sm-4">
                <div class="avatar-thumbnail">
                  <div class="crop" ng-if="!PatientRecordCtrl.patient.avatar">
                    <span class="glyphicon glyphicon-picture"></span>
                  </div>
                  <div class="crop" ng-if="PatientRecordCtrl.patient.avatar">
                    <img ng-src="{{ PatientRecordCtrl.patient.avatar }}" style="width: 50%; height: auto" onError="this.src='assets/empty.png';" >
                  </div>
                </div>

                <label class="btn btn-default btn-block">
                    <span class="glyphicon glyphicon-upload"></span> {{ PatientRecordCtrl.uploadButtonText | translate }}
                    <input type="file" accept="image/*" ngf-max-size="2MB" ngf-select="PatientRecordCtrl.uploadFiles($file, $invalidFiles)" style="display: none;">
                </label>

                <a
                  data-method="edit"
                  ui-sref="patientEdit({ uuid : PatientRecordCtrl.patient.uuid })"
                  class="btn btn-default btn-block">
                  <span class="glyphicon glyphicon-edit"></span>
                  <span translate>PATIENT_EDIT.EDIT_DETAILS</span>
                </a>
              </div>
            </div>
          </div>
        </div>
      </div> <!-- End patient details row -->

      <div class="row">
        <div class="col-sm-6">
          <bh-find-document
            patient-uuid="PatientRecordCtrl.patient.uuid"
            enable-patient-details="false"
            enable-search="false"
            enable-option-bar="true"
            display="default"
            height="250px">
          </bh-find-document>
        </div>

        <div class="col-sm-6">
          <bh-patient-visit patient-uuid="PatientRecordCtrl.patient.uuid">
          </bh-patient-visit>
        </div>
      </div>

      <div class="row">

        <!-- Patient Bill Panel -->
        <div class="col-sm-12">
          <bh-latest-patient-invoice debtor-uuid="PatientRecordCtrl.patient.debtor_uuid">
          </bh-latest-patient-invoice>
        </div>
      </div>
    </div>
  </div>
</div>
